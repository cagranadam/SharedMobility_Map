<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shared Mobility Map</title>
    
    <!-- Include Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>
    
    <!-- Include Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>
    
    <!-- Include PapaParse library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <!-- Modal for displaying city information -->
    <div id="city-info-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80%; max-width: 600px; padding: 20px; background-color: white; border: 1px solid #ccc; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); z-index: 10000;">
        <button class="close-modal-x" onclick="closeModal()">x</button>
        <button onclick="window.open('https://docs.google.com/spreadsheets/d/15uH6UtMXNv1Dy05_lBXuR2wdumAZeEjw/edit?usp=sharing&ouid=101077609368645167402&rtpof=true&sd=true', '_blank')" class="edit-table-button">Edit table</button>
        <div id="city-info-content">
            <div class="scroll-container">
                <!-- Table content will be inserted here -->
                <table>
                    <!-- Your table content -->
                </table>
            </div>
        </div>
    </div>

    <!-- CSS for map height and other styles -->
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }       
        
        #map { height: 100%; width: 100%;}
        .custom-icon { background-color: green; width: 18px; height: 18px; border-radius: 50%; }
        
        .leaflet-control-layers {
            position: absolute;
            bottom: 10px;
            left: 10px;
            border: 2px solid #8cc84b;
            background: white;
            box-shadow: 0 1px 5px rgba(0,0,0,0.65);
            border-radius: 5px;
            padding: 10px;
            z-index: 1000;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            
        }

        .layer-title {
            font-weight: bold;
            margin-bottom: 10px;
            font: 14px Arial, sans-serif;
        }

        .section-title {
            font-weight: bold;
            margin-bottom: 5px;
            font: 14px Arial, sans-serif;
        } 

        .mode-buttons {
            display: flex;
            flex-direction: column;
            margin-right: 10px;
            
        }

        .model-buttons {
            display: flex;
            flex-direction: column;
            
        } 

        .info.legend {
            padding: 6px 8px;
            font: 14px Arial, sans-serif;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            max-width: 250px; /* Set the max-width to make the legend less wide */
            word-wrap: break-word; /* Ensure long URLs or text wrap properly */
        }


 
        .mode-button, .model-button {
            display: block;
            margin: 5px 0;
            padding: 5px 10px;
            background-color: #808080;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .mode-button.active, .model-button.active {
            background-color: #8cc84b;
        }
        
        button {
            background-color: #808080;
            color: black;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 4px;
            transition: background-color 0.3s;
        }

        button.active {
            background-color: #4CAF50;
        }

        button:hover {
            background-color: #45a049;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: auto;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        #city-info-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 800px;
            padding: 20px;
            background-color: white;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 10000;
            overflow-y: auto;
            max-height: 90vh;
        }

        #city-info-content {
            position: relative;
            margin-top: 60px;
        }

        .scroll-container {
            overflow-x: auto;
            overflow-y: hidden;
            position: relative;
            white-space: nowrap;
            display: flex;
            flex-direction: column-reverse;
        }

        .scroll-container::-webkit-scrollbar {
            height: 12px;
        }

        .scroll-container::-webkit-scrollbar-thumb {
            background-color: #ccc;
            border-radius: 10px;
        }

        .scroll-container::-webkit-scrollbar-track {
            background-color: #f1f1f1;
        }

        .close-modal-x,
        .edit-table-button {
            position: absolute;
            top: 10px;
            padding: 10px 20px;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .close-modal-x {
            right: 10px;
            background-color: #4CAF50;
        }

        .edit-table-button {
            right: 100px;
            background-color: #008CBA;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div id="data-table-container"></div>
    <div class="leaflet-control-layers">
        <div class="mode-buttons"></div>
        <div class="model-buttons"></div>
    </div>
    

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var map = L.map('map').setView([50.8503, 4.3517], 4);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors'
            }).addTo(map);

            var modeButtons = {};
            var cities = {};
            var modesFilter = {};
            var modelButtons = {};
            var modelsFilter = { 'Station-based': true, 'Freefloating': true };
            var icons = {
                'Bike Sharing': L.divIcon({ className: 'custom-icon bike' }),
                'Car Sharing': L.divIcon({ className: 'custom-icon car' }),
                'Scooter Sharing': L.divIcon({ className: 'custom-icon scooter' }),
                'Moped Sharing': L.divIcon({ className: 'custom-icon moped' }),
                'Cargo Bike Sharing': L.divIcon({ className: 'custom-icon cargo' })
            };

            function getIconForMode(mode) {
                return icons[mode] || L.divIcon({ className: 'custom-icon' });
            }

            function createLegend() {
                var legend = L.control({ position: 'topleft' });
                legend.onAdd = function () {
                    var div = L.DomUtil.create('div', 'info legend');
                    div.innerHTML = `
                        <h4>Shared Mobility Map</h4>                        
                        <!-- Embed your SVG content directly here -->
                        <svg version="1.1" id="Layer_1" xmlns:x="&ns_extend;" xmlns:i="&ns_ai;" xmlns:graph="&ns_graphs;"
                                xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 408 102"
                                style="enable-background:new 0 0 408 102;" xml:space="preserve">
                            <style type="text/css">
                                .st0{fill:#65A812;}
                                .st1{fill:#FFFFFF;}
                                .st2{fill:#002E65;}
                                .st3{fill:none;}
                            </style>
                            <metadata>
                                <sfw  xmlns="&ns_sfw;">
                                    <slices></slices>
                                    <sliceSourceBounds  bottomLeftOrigin="true" height="102" width="403.7988281" x="0" y="-102"></sliceSourceBounds>
                                </sfw>
                            </metadata>
                            <g>
                                <g>
                                    <path class="st0" d="M96.9000015,102H5.0999999C2.2950001,102,0,99.7050018,0,96.9000015V5.0999999
                                        C0,2.2950001,2.2950001,0,5.0999999,0h91.8000031C99.7050018,0,102,2.2950001,102,5.0999999v91.8000031
                                        C102,99.7050018,99.7050018,102,96.9000015,102z"/>
                                </g>
                                <g>
                                    <path class="st1" d="M65.4393311,54.0225143c0.4325027,12.3328857-4.6385117,21.2498322-15.8150101,21.2498322
                                        c-8.70467,0-17.5176468-6.5201035-17.5176468-19.4506874V21.144659H17.7737331v35.4050369
                                        c0,13.4108734,8.9826431,27.1654587,29.6760654,27.1654587c20.0859604,0,28.1678848-14.4148712,28.2588959-26.368454
                                        c14.665535,2.260498,21.3881149-8.6823463,19.4711151-16.1329613c-2.5612259,2.9579849-6.6571045,5.5772667-19.4536514,1.9484215
                                        V21.144659H65.4393311v18.5292034C45.3423157,33.076992,40.5864944,51.3857727,40.5864944,51.3857727
                                        S49.9853058,46.2166176,65.4393311,54.0225143"/>
                                </g>
                            </g>
                            <g>
                                <path class="st2" d="M152.784668,63.640625V49.9902344h-3.0161133v-2.6000977h8.8920898v2.6000977h-3.0161133V63.640625H152.784668
                                    z"/>
                                <path class="st2" d="M160.4541016,63.640625V47.3901367h2.9379883c3.5361328,0,5.590332,1.5859375,5.590332,5.434082
                                    c0,3.796875-1.9238281,5.7207031-5.2519531,5.7207031h-0.4160156v5.0957031H160.4541016z M163.5224609,56.0488281
                                    c1.7939453,0,2.4960938-0.9101562,2.4960938-3.1201172c0-2.1586914-0.7802734-2.9384766-2.4702148-2.9384766h-0.2338867v6.0585938
                                    H163.5224609z"/>
                                <path class="st2" d="M176.9902344,63.640625l-2.0537109-5.8759766l-1.1445312,0.15625v5.7197266h-2.8598633V47.3901367h3.8481445
                                    c3.328125,0,4.7583008,1.9760742,4.7583008,4.9926758c0,2.1054688-0.7802734,3.7695312-2.0283203,4.5234375l2.4960938,6.734375
                                    H176.9902344z M174.234375,55.3466797c1.6376953-0.1044922,2.3398438-0.9365234,2.3398438-2.8339844
                                    c0-1.8725586-0.7797852-2.5483398-2.2880859-2.5483398h-0.4941406v5.4086914L174.234375,55.3466797z"/>
                                <path class="st2" d="M213.7416992,63.640625l-2.2880859-6.5263672l-1.6118164,0.234375v6.2919922h-1.9501953V47.3901367h2.7299805
                                    c3.4321289,0,4.7060547,1.9238281,4.7060547,4.7583008c0,2.0019531-0.8320312,3.6923828-2.0541992,4.3945312l2.4960938,7.0976562
                                    H213.7416992z M210.2578125,55.4765625c2.1577148-0.2080078,3.0678711-1.1435547,3.0678711-3.328125
                                    c0-2.1582031-0.9619141-2.9643555-2.9121094-2.9643555h-0.5717773v6.3188477L210.2578125,55.4765625z"/>
                                <path class="st2" d="M223.7255859,62.8613281c-0.6499023,0.7011719-1.3515625,1.1171875-2.4960938,1.1171875
                                    c-2.5737305,0-3.9521484-2.1318359-3.9521484-6.265625c0-4.1865234,1.6640625-6.3188477,3.7963867-6.3188477
                                    c2.1582031,0,3.1201172,1.7944336,3.1201172,4.8364258c0,0.3125-0.0522461,1.2998047-0.1298828,1.8203125h-4.8881836
                                    c0.0517578,2.8857422,0.7280273,4.2636719,2.2617188,4.2636719c0.8061523,0,1.3525391-0.5195312,1.8720703-1.2216797
                                    L223.7255859,62.8613281z M222.4257812,56.1523438c0-2.2353516-0.5200195-3.09375-1.4560547-3.09375
                                    c-0.9101562,0-1.6640625,1.2744141-1.7680664,3.5361328h3.2241211V56.1523438z"/>
                                <path class="st2" d="M226.4296875,61.4052734c0.7016602,0.5712891,1.4560547,0.9355469,2.2099609,0.9355469
                                    c0.987793,0,1.5859375-0.7275391,1.5859375-1.6904297c0-0.9619141-0.5200195-1.6113281-1.7680664-2.3398438
                                    c-1.5341797-0.9101562-2.4438477-1.9755859-2.4438477-3.6923828c0-1.9238281,1.4560547-3.2241211,3.2758789-3.2241211
                                    c0.9619141,0,1.8461914,0.3901367,2.4179688,0.8061523l-0.3901367,1.6640625
                                    c-0.6499023-0.4677734-1.3256836-0.8056641-2.0537109-0.8056641c-0.8583984,0-1.4824219,0.5722656-1.4824219,1.5341797
                                    c0,0.9101562,0.3901367,1.5078125,1.6640625,2.2880859c1.5083008,0.9355469,2.5483398,2.0019531,2.5483398,3.7441406
                                    c0,2.0019531-1.4560547,3.3535156-3.3022461,3.3535156c-0.9619141,0-1.9501953-0.3632812-2.6518555-0.9091797
                                    L226.4296875,61.4052734z"/>
                                <path class="st2" d="M240.3134766,62.8613281c-0.6499023,0.7011719-1.3515625,1.1171875-2.4960938,1.1171875
                                    c-2.5737305,0-3.9521484-2.1318359-3.9521484-6.265625c0-4.1865234,1.6640625-6.3188477,3.7963867-6.3188477
                                    c2.1582031,0,3.1201172,1.7944336,3.1201172,4.8364258c0,0.3125-0.0522461,1.2998047-0.1298828,1.8203125h-4.8881836
                                    c0.0517578,2.8857422,0.7280273,4.2636719,2.2617188,4.2636719c0.8061523,0,1.3525391-0.5195312,1.8720703-1.2216797
                                    L240.3134766,62.8613281z M239.0136719,56.1523438c0-2.2353516-0.5200195-3.09375-1.4560547-3.09375
                                    c-0.9101562,0-1.6640625,1.2744141-1.7680664,3.5361328h3.2241211V56.1523438z"/>
                                <path class="st2" d="M249.8295898,63.875c-1.3261719,0.15625-2.1582031-0.234375-2.4702148-1.2216797h-0.1040039
                                    c-0.3637695,0.7275391-1.0400391,1.3251953-2.184082,1.3251953c-1.3779297,0-2.4697266-1.3515625-2.4697266-3.2236328
                                    c0-2.1845703,1.4038086-4.1865234,4.6538086-4.4726562v-1.0654297c0-1.2480469-0.4418945-2.1318359-1.6118164-2.1318359
                                    c-0.7021484,0-1.6904297,0.5712891-2.4443359,1.3779297l-0.2861328-1.7421875
                                    c0.7285156-0.8325195,1.9501953-1.3266602,2.9643555-1.3266602c2.262207,0,3.2241211,1.8208008,3.2241211,3.7446289v6.3183594
                                    c0,0.5976562,0.2338867,0.8574219,0.8837891,0.8574219L249.8295898,63.875z M247.2553711,57.6865234
                                    c-2.0019531,0.3378906-2.7558594,1.5605469-2.7558594,2.8603516c0,1.1181641,0.5458984,1.6640625,1.2998047,1.6640625
                                    c0.5463867,0,1.0922852-0.5722656,1.4560547-1.1699219V57.6865234z"/>
                                <path class="st2" d="M252.2734375,63.640625V51.7841797l1.8457031-0.3378906v2.1064453
                                    c0.4160156-1.3525391,1.1181641-2.1586914,2.0800781-2.1586914c0.4677734,0,0.9101562,0.234375,1.2734375,0.5458984
                                    l-0.3896484,1.9243164c-0.3115234-0.2861328-0.6757812-0.5712891-1.0654297-0.5712891
                                    c-0.6767578,0-1.3789062,1.0136719-1.8984375,2.859375v7.4882812H252.2734375z"/>
                                <path class="st2" d="M264.8046875,62.8613281c-0.5976562,0.7011719-1.4560547,1.1171875-2.4960938,1.1171875
                                    c-2.4960938,0-3.9257812-2.1318359-3.9257812-6.265625c0-4.1083984,1.4560547-6.3188477,4.0292969-6.3188477
                                    c1.0146484,0,1.7949219,0.3901367,2.4189453,1.0405273l-0.4423828,1.8457031
                                    c-0.4160156-0.6757812-1.2216797-1.2216797-1.8720703-1.2216797c-1.5595703,0-2.2099609,1.5859375-2.2099609,4.6279297
                                    c0,3.1201172,0.6757812,4.6279297,2.2880859,4.6279297c0.6757812,0,1.2998047-0.5195312,1.7939453-1.2216797
                                    L264.8046875,62.8613281z"/>
                                <path class="st2" d="M272.0332031,63.640625v-8.8916016c0-1.0927734-0.46875-1.5605469-1.2226562-1.5605469
                                    c-0.6240234,0-1.3261719,0.5976562-1.8984375,1.3779297v9.0742188h-1.8457031V46.1157227l1.8457031-0.3378906v7.2026367
                                    c0.625-1.0664062,1.6386719-1.5864258,2.5488281-1.5864258c1.5595703,0,2.4179688,1.4301758,2.4179688,2.9907227v9.2558594
                                    H272.0332031z"/>
                                <path class="st2" d="M287.1904297,57.1142578h-2.1582031v-1.8193359h3.9267578v7.1757812
                                    c-0.8066406,1.0146484-1.9765625,1.5078125-3.2246094,1.5078125c-3.0683594,0-4.9140625-2.6777344-4.9140625-8.4501953
                                    c0-5.4863281,1.7939453-8.4760742,4.8359375-8.4760742c1.2480469,0,2.3398438,0.4418945,3.1201172,1.3256836l-0.5205078,1.8461914
                                    c-0.7011719-0.8061523-1.5332031-1.3779297-2.4960938-1.3779297c-2.0537109,0-2.9375,2.3662109-2.9375,6.6040039
                                    c0,4.4208984,1.0664062,6.7871094,3.09375,6.7871094c0.46875,0,0.8583984-0.1308594,1.2744141-0.390625V57.1142578z"/>
                                <path class="st2" d="M291.7138672,63.640625V51.7841797l1.8466797-0.3378906v2.1064453
                                    c0.4160156-1.3525391,1.1171875-2.1586914,2.0800781-2.1586914c0.4667969,0,0.9091797,0.234375,1.2734375,0.5458984
                                    l-0.390625,1.9243164c-0.3115234-0.2861328-0.6757812-0.5712891-1.0654297-0.5712891
                                    c-0.6757812,0-1.3779297,1.0136719-1.8974609,2.859375v7.4882812H291.7138672z"/>
                                <path class="st2" d="M297.8232422,57.7128906c0-4.1083984,1.4306641-6.3188477,3.9267578-6.3188477
                                    s3.8476562,2.1323242,3.8476562,6.2670898c0,4.1074219-1.4824219,6.3173828-3.9257812,6.3173828
                                    C299.2011719,63.9785156,297.8232422,61.8466797,297.8232422,57.7128906z M303.6738281,57.7128906
                                    c0-3.1201172-0.6240234-4.6542969-1.9765625-4.6542969c-1.3515625,0-1.9492188,1.5859375-1.9492188,4.6279297
                                    c0,3.1201172,0.5976562,4.6279297,1.9492188,4.6279297C303.0498047,62.3144531,303.6738281,60.703125,303.6738281,57.7128906z"/>
                                <path class="st2" d="M312.9550781,63.9267578v-1.5341797c-0.6230469,1.0664062-1.6376953,1.5859375-2.546875,1.5859375
                                    c-1.5605469,0-2.4189453-1.4296875-2.4189453-2.9892578v-9.2573242h1.8466797V60.625
                                    c0,1.0917969,0.4677734,1.5595703,1.2216797,1.5595703c0.6240234,0,1.2998047-0.5976562,1.8974609-1.3779297v-9.074707h1.8466797
                                    v11.8569336L312.9550781,63.9267578z"/>
                                <path class="st2" d="M317.7128906,69.4648438V51.7841797l1.8466797-0.3378906v1.3779297
                                    c0.4941406-0.8320312,1.2998047-1.4301758,2.1845703-1.4301758c2.0019531,0,3.25,2.496582,3.25,6.1362305
                                    c0,3.875-1.4306641,6.4482422-3.6660156,6.4482422c-0.703125,0-1.2744141-0.1552734-1.7685547-0.4677734v5.9541016H317.7128906z
                                    M319.5595703,61.6386719c0.3378906,0.390625,0.8583984,0.6757812,1.3779297,0.6757812
                                    c1.3515625,0,2.1318359-1.9238281,2.1318359-4.6533203c0-2.6005859-0.7275391-4.4208984-1.9755859-4.4208984
                                    c-0.5976562,0-1.1445312,0.46875-1.5341797,1.1699219V61.6386719z"/>
                                <path class="st2" d="M333.1318359,63.640625V49.2099609h-3.1201172v-1.8198242h8.1904297v1.8198242h-3.1201172V63.640625
                                    H333.1318359z"/>
                                <path class="st2" d="M339.0078125,63.640625V51.7841797l1.8457031-0.3378906v2.1064453
                                    c0.4160156-1.3525391,1.1181641-2.1586914,2.0800781-2.1586914c0.46875,0,0.9101562,0.234375,1.2744141,0.5458984
                                    l-0.3896484,1.9243164c-0.3125-0.2861328-0.6757812-0.5712891-1.0664062-0.5712891
                                    c-0.6757812,0-1.3779297,1.0136719-1.8984375,2.859375v7.4882812H339.0078125z"/>
                                <path class="st2" d="M352.3720703,63.875c-1.3261719,0.15625-2.1582031-0.234375-2.4697266-1.2216797h-0.1044922
                                    c-0.3642578,0.7275391-1.0400391,1.3251953-2.1845703,1.3251953c-1.3769531,0-2.4697266-1.3515625-2.4697266-3.2236328
                                    c0-2.1845703,1.4042969-4.1865234,4.6542969-4.4726562v-1.0654297c0-1.2480469-0.4423828-2.1318359-1.6123047-2.1318359
                                    c-0.7011719,0-1.6894531,0.5712891-2.4433594,1.3779297l-0.2861328-1.7421875
                                    c0.7275391-0.8325195,1.9501953-1.3266602,2.9638672-1.3266602c2.2617188,0,3.2246094,1.8208008,3.2246094,3.7446289v6.3183594
                                    c0,0.5976562,0.2333984,0.8574219,0.8837891,0.8574219L352.3720703,63.875z M349.7978516,57.6865234
                                    c-2.0019531,0.3378906-2.7558594,1.5605469-2.7558594,2.8603516c0,1.1181641,0.5458984,1.6640625,1.2998047,1.6640625
                                    c0.5458984,0,1.0917969-0.5722656,1.4560547-1.1699219V57.6865234z"/>
                                <path class="st2" d="M359.78125,63.640625v-8.8916016c0-1.0927734-0.4677734-1.5605469-1.2216797-1.5605469
                                    c-0.6240234,0-1.3261719,0.5976562-1.8974609,1.3779297v9.0742188h-1.8466797V51.7841797l1.8466797-0.3378906v1.5341797
                                    c0.6230469-1.0664062,1.6376953-1.5864258,2.546875-1.5864258c1.5605469,0,2.4189453,1.4301758,2.4189453,2.9907227v9.2558594
                                    H359.78125z"/>
                                <path class="st2" d="M364.3310547,61.4052734c0.7021484,0.5712891,1.4560547,0.9355469,2.2099609,0.9355469
                                    c0.9882812,0,1.5859375-0.7275391,1.5859375-1.6904297c0-0.9619141-0.5195312-1.6113281-1.7675781-2.3398438
                                    c-1.5341797-0.9101562-2.4443359-1.9755859-2.4443359-3.6923828c0-1.9238281,1.4560547-3.2241211,3.2763672-3.2241211
                                    c0.9619141,0,1.8457031,0.3901367,2.4179688,0.8061523l-0.3896484,1.6640625
                                    c-0.6503906-0.4677734-1.3261719-0.8056641-2.0537109-0.8056641c-0.8583984,0-1.4824219,0.5722656-1.4824219,1.5341797
                                    c0,0.9101562,0.3896484,1.5078125,1.6640625,2.2880859c1.5078125,0.9355469,2.5478516,2.0019531,2.5478516,3.7441406
                                    c0,2.0019531-1.4560547,3.3535156-3.3017578,3.3535156c-0.9628906,0-1.9501953-0.3632812-2.6523438-0.9091797
                                    L364.3310547,61.4052734z"/>
                                <path class="st2" d="M372.2353516,69.4648438V51.7841797l1.8466797-0.3378906v1.3779297
                                    c0.4931641-0.8320312,1.2988281-1.4301758,2.1835938-1.4301758c2.0019531,0,3.25,2.496582,3.25,6.1362305
                                    c0,3.875-1.4296875,6.4482422-3.6660156,6.4482422c-0.7021484,0-1.2744141-0.1552734-1.7675781-0.4677734v5.9541016H372.2353516z
                                    M374.0820312,61.6386719c0.3378906,0.390625,0.8574219,0.6757812,1.3769531,0.6757812
                                    c1.3525391,0,2.1328125-1.9238281,2.1328125-4.6533203c0-2.6005859-0.7285156-4.4208984-1.9765625-4.4208984
                                    c-0.5976562,0-1.1435547,0.46875-1.5332031,1.1699219V61.6386719z"/>
                                <path class="st2" d="M381.6992188,57.7128906c0-4.1083984,1.4296875-6.3188477,3.9257812-6.3188477
                                    s3.8476562,2.1323242,3.8476562,6.2670898c0,4.1074219-1.4814453,6.3173828-3.9257812,6.3173828
                                    C383.0771484,63.9785156,381.6992188,61.8466797,381.6992188,57.7128906z M387.5488281,57.7128906
                                    c0-3.1201172-0.6230469-4.6542969-1.9755859-4.6542969s-1.9501953,1.5859375-1.9501953,4.6279297
                                    c0,3.1201172,0.5976562,4.6279297,1.9501953,4.6279297S387.5488281,60.703125,387.5488281,57.7128906z"/>
                                <path class="st2" d="M391.9169922,63.640625V51.7841797l1.8466797-0.3378906v2.1064453
                                    c0.4160156-1.3525391,1.1171875-2.1586914,2.0800781-2.1586914c0.4667969,0,0.9091797,0.234375,1.2734375,0.5458984
                                    l-0.390625,1.9243164c-0.3115234-0.2861328-0.6757812-0.5712891-1.0654297-0.5712891
                                    c-0.6757812,0-1.3779297,1.0136719-1.8974609,2.859375v7.4882812H391.9169922z"/>
                                <path class="st2" d="M403.7988281,63.4326172c-0.4941406,0.3378906-1.1953125,0.5458984-1.7158203,0.5458984
                                    c-1.3261719,0-2.6005859-0.6757812-2.6005859-3.6914062v-6.7607422l-1.1953125-0.1298828v-1.2480469l1.1953125-0.4682617
                                    v-2.6782227h1.8466797v2.7299805h2.3916016l-0.1035156,1.6645508h-2.2880859V60.46875
                                    c0,1.3779297,0.4677734,1.8203125,1.0654297,1.8203125c0.390625,0,0.8583984-0.2597656,1.1699219-0.5458984L403.7988281,63.4326172
                                    z"/>
                                <path class="st2" d="M157.3867188,86.875c-1.3261719,0.15625-2.1582031-0.234375-2.4702148-1.2216797H154.8125
                                    c-0.3637695,0.7275391-1.0400391,1.3251953-2.184082,1.3251953c-1.3779297,0-2.4702148-1.3515625-2.4702148-3.2236328
                                    c0-2.1845703,1.4042969-4.1865234,4.6542969-4.4726562v-1.0654297c0-1.2480469-0.4418945-2.1318359-1.6118164-2.1318359
                                    c-0.7021484,0-1.6899414,0.5712891-2.4443359,1.3779297l-0.2856445-1.7421875
                                    c0.7275391-0.8320312,1.949707-1.3261719,2.9638672-1.3261719c2.262207,0,3.2241211,1.8203125,3.2241211,3.7441406v6.3183594
                                    c0,0.5976562,0.2338867,0.8574219,0.8842773,0.8574219L157.3867188,86.875z M154.8125,80.6865234
                                    c-2.0019531,0.3378906-2.7558594,1.5605469-2.7558594,2.8603516c0,1.1181641,0.5458984,1.6640625,1.2998047,1.6640625
                                    c0.5458984,0,1.0922852-0.5722656,1.4560547-1.1699219V80.6865234z"/>
                                <path class="st2" d="M164.7963867,86.640625v-8.8916016c0-1.0927734-0.4677734-1.5605469-1.222168-1.5605469
                                    c-0.6240234,0-1.3256836,0.5976562-1.8979492,1.3779297v9.0742188h-1.8461914V74.7841797l1.8461914-0.3378906v1.5341797
                                    c0.6240234-1.0664062,1.6381836-1.5859375,2.5483398-1.5859375c1.5600586,0,2.4179688,1.4296875,2.4179688,2.9902344v9.2558594
                                    H164.7963867z"/>
                                <path class="st2" d="M174.4682617,86.640625v-1.0917969c-0.5200195,0.8056641-1.2998047,1.4296875-2.184082,1.4296875
                                    c-2.0019531,0-3.25-2.4960938-3.25-6.1357422c0-3.8740234,1.4301758-6.4482422,3.6660156-6.4482422
                                    c0.7021484,0,1.2744141,0.15625,1.7680664,0.4677734v-5.7460938l1.8461914-0.3378906V86.640625H174.4682617z
                                    M174.4682617,76.734375c-0.3378906-0.3896484-0.8579102-0.6757812-1.3779297-0.6757812
                                    c-1.3520508,0-2.1323242,1.9238281-2.1323242,4.6542969c0,2.5996094,0.7285156,4.4199219,1.9765625,4.4199219
                                    c0.5976562,0,1.1435547-0.4941406,1.5336914-1.1699219V76.734375z"/>
                                <path class="st2" d="M189.6782227,86.640625l-2.2880859-6.5263672l-1.6118164,0.234375v6.2919922h-1.9501953v-16.25h2.7299805
                                    c3.4321289,0,4.7060547,1.9238281,4.7060547,4.7578125c0,2.0019531-0.8320312,3.6923828-2.0541992,4.3945312l2.4960938,7.0976562
                                    H189.6782227z M186.1943359,78.4765625c2.1577148-0.2080078,3.0678711-1.1435547,3.0678711-3.328125
                                    c0-2.1582031-0.9619141-2.9638672-2.9121094-2.9638672h-0.5717773v6.3183594L186.1943359,78.4765625z"/>
                                <path class="st2" d="M199.6621094,85.8613281c-0.6499023,0.7011719-1.3515625,1.1171875-2.4960938,1.1171875
                                    c-2.5737305,0-3.9521484-2.1318359-3.9521484-6.265625c0-4.1865234,1.6640625-6.3183594,3.7963867-6.3183594
                                    c2.1582031,0,3.1201172,1.7939453,3.1201172,4.8359375c0,0.3125-0.0522461,1.2998047-0.1298828,1.8203125h-4.8881836
                                    c0.0517578,2.8857422,0.7280273,4.2636719,2.2617188,4.2636719c0.8061523,0,1.3525391-0.5195312,1.8720703-1.2216797
                                    L199.6621094,85.8613281z M198.3623047,79.1523438c0-2.2353516-0.5200195-3.09375-1.4560547-3.09375
                                    c-0.9101562,0-1.6640625,1.2744141-1.7680664,3.5361328h3.2241211V79.1523438z"/>
                                <path class="st2" d="M208.1381836,76.5263672c0.3901367,0.5458984,0.5717773,1.5605469,0.5717773,2.3925781
                                    c0,2.8857422-1.4560547,4.3417969-3.3798828,4.3417969c-0.2338867,0-0.6240234-0.0263672-0.9882812-0.2080078
                                    c-0.3896484,0.1816406-0.7275391,0.5722656-0.7275391,1.1445312c0,0.6757812,0.5458984,1.1435547,1.5336914,1.1435547
                                    c0,0,0.7802734,0,0.8061523,0c2.2363281,0,3.9521484,0.9882812,3.9521484,3.25c0,2.2363281-1.8461914,4.2119141-4.472168,4.2119141
                                    c-2.2358398,0-3.9262695-1.1435547-3.9262695-3.25c0-1.2998047,0.9360352-2.3398438,2.0541992-2.7041016
                                    c-0.9101562-0.3115234-1.4819336-1.2998047-1.4819336-2.2099609c0-0.9882812,0.5976562-1.7421875,1.4038086-2.1582031
                                    c-0.8061523-0.5712891-1.3520508-1.8720703-1.3520508-3.6142578c0-2.9638672,1.4301758-4.4716797,3.328125-4.4716797
                                    c0.7802734,0,1.5600586,0.3642578,1.9243164,0.7021484l2.3398438-0.2080078l0.078125,1.8457031L208.1381836,76.5263672z
                                    M203.328125,89.2412109c0,1.1962891,0.7280273,2.1054688,2.2617188,2.1054688
                                    c1.3525391,0,2.3925781-0.8320312,2.3925781-2.3398438c0-1.2734375-0.6240234-1.8720703-2.2104492-1.8720703
                                    c-0.3120117,0-0.8061523,0-1.144043-0.0517578C203.9257812,87.4472656,203.328125,88.1230469,203.328125,89.2412109z
                                    M206.8642578,78.8408203c0-1.8984375-0.4941406-2.8603516-1.3779297-2.8603516
                                    c-0.8320312,0-1.4560547,0.7021484-1.4560547,2.9384766c0,2.0273438,0.5458984,2.859375,1.4038086,2.859375
                                    C206.2661133,81.7783203,206.8642578,80.9726562,206.8642578,78.8408203z"/>
                                <path class="st2" d="M211.1796875,70.5458984c0-0.8056641,0.4682617-1.5078125,1.3261719-1.5078125
                                    s1.3261719,0.7021484,1.3261719,1.5078125c0,0.8066406-0.4682617,1.5087891-1.3261719,1.5087891
                                    S211.1796875,71.3525391,211.1796875,70.5458984z M211.5698242,86.640625V74.7841797l1.8461914-0.3378906V86.640625H211.5698242z"
                                    />
                                <path class="st2" d="M215.9116211,80.7128906c0-4.1083984,1.4301758-6.3183594,3.9262695-6.3183594
                                    s3.8481445,2.1318359,3.8481445,6.2666016c0,4.1074219-1.4819336,6.3173828-3.9262695,6.3173828
                                    C217.2895508,86.9785156,215.9116211,84.8466797,215.9116211,80.7128906z M221.7617188,80.7128906
                                    c0-3.1201172-0.6240234-4.6542969-1.9760742-4.6542969s-1.949707,1.5859375-1.949707,4.6279297
                                    c0,3.1201172,0.5976562,4.6279297,1.949707,4.6279297S221.7617188,83.703125,221.7617188,80.7128906z"/>
                                <path class="st2" d="M231.0957031,86.640625v-8.8916016c0-1.0927734-0.4677734-1.5605469-1.2216797-1.5605469
                                    c-0.6240234,0-1.3261719,0.5976562-1.8984375,1.3779297v9.0742188h-1.8457031V74.7841797l1.8457031-0.3378906v1.5341797
                                    c0.6240234-1.0664062,1.6381836-1.5859375,2.5483398-1.5859375c1.5600586,0,2.4179688,1.4296875,2.4179688,2.9902344v9.2558594
                                    H231.0957031z"/>
                                <path class="st2" d="M242.4580078,86.875c-1.3261719,0.15625-2.1582031-0.234375-2.4702148-1.2216797h-0.1040039
                                    c-0.3642578,0.7275391-1.0400391,1.3251953-2.184082,1.3251953c-1.378418,0-2.4702148-1.3515625-2.4702148-3.2236328
                                    c0-2.1845703,1.4042969-4.1865234,4.6542969-4.4726562v-1.0654297c0-1.2480469-0.4423828-2.1318359-1.6123047-2.1318359
                                    c-0.7021484,0-1.6899414,0.5712891-2.4438477,1.3779297l-0.2861328-1.7421875
                                    c0.7280273-0.8320312,1.9501953-1.3261719,2.9643555-1.3261719c2.2617188,0,3.2236328,1.8203125,3.2236328,3.7441406v6.3183594
                                    c0,0.5976562,0.234375,0.8574219,0.8842773,0.8574219L242.4580078,86.875z M239.8837891,80.6865234
                                    c-2.0019531,0.3378906-2.7563477,1.5605469-2.7563477,2.8603516c0,1.1181641,0.5463867,1.6640625,1.300293,1.6640625
                                    c0.5458984,0,1.0917969-0.5722656,1.4560547-1.1699219V80.6865234z"/>
                                <path class="st2" d="M244.9013672,86.640625V69.1162109l1.8461914-0.3378906V86.640625H244.9013672z"/>
                                <path class="st2" d="M254.2617188,86.640625v-16.25h6.4472656v1.8193359h-4.4980469v5.3564453h3.640625v1.8203125h-3.640625
                                    v5.4345703h4.4980469v1.8193359H254.2617188z"/>
                                <path class="st2" d="M268.8476562,85.8613281c-0.5986328,0.7011719-1.4570312,1.1171875-2.4960938,1.1171875
                                    c-2.4960938,0-3.9267578-2.1318359-3.9267578-6.265625c0-4.1083984,1.4560547-6.3183594,4.0302734-6.3183594
                                    c1.0136719,0,1.7939453,0.3896484,2.4179688,1.0400391l-0.4414062,1.8457031
                                    c-0.4160156-0.6757812-1.2226562-1.2216797-1.8730469-1.2216797c-1.5595703,0-2.2099609,1.5859375-2.2099609,4.6279297
                                    c0,3.1201172,0.6767578,4.6279297,2.2880859,4.6279297c0.6757812,0,1.3007812-0.5195312,1.7949219-1.2216797
                                    L268.8476562,85.8613281z"/>
                                <path class="st2" d="M270.3808594,80.7128906c0-4.1083984,1.4296875-6.3183594,3.9257812-6.3183594
                                    s3.8486328,2.1318359,3.8486328,6.2666016c0,4.1074219-1.4814453,6.3173828-3.9257812,6.3173828
                                    C271.7597656,86.9785156,270.3808594,84.8466797,270.3808594,80.7128906z M276.2314453,80.7128906
                                    c0-3.1201172-0.6240234-4.6542969-1.9755859-4.6542969c-1.3525391,0-1.9511719,1.5859375-1.9511719,4.6279297
                                    c0,3.1201172,0.5986328,4.6279297,1.9511719,4.6279297C275.6074219,85.3144531,276.2314453,83.703125,276.2314453,80.7128906z"/>
                                <path class="st2" d="M285.5654297,86.640625v-8.8916016c0-1.0927734-0.4677734-1.5605469-1.2216797-1.5605469
                                    c-0.625,0-1.3261719,0.5976562-1.8984375,1.3779297v9.0742188h-1.8457031V74.7841797l1.8457031-0.3378906v1.5341797
                                    c0.6240234-1.0664062,1.6376953-1.5859375,2.5478516-1.5859375c1.5595703,0,2.4179688,1.4296875,2.4179688,2.9902344v9.2558594
                                    H285.5654297z"/>
                                <path class="st2" d="M289.8027344,80.7128906c0-4.1083984,1.4296875-6.3183594,3.9257812-6.3183594
                                    s3.8486328,2.1318359,3.8486328,6.2666016c0,4.1074219-1.4814453,6.3173828-3.9257812,6.3173828
                                    C291.1816406,86.9785156,289.8027344,84.8466797,289.8027344,80.7128906z M295.6533203,80.7128906
                                    c0-3.1201172-0.6240234-4.6542969-1.9755859-4.6542969c-1.3525391,0-1.9511719,1.5859375-1.9511719,4.6279297
                                    c0,3.1201172,0.5986328,4.6279297,1.9511719,4.6279297C295.0292969,85.3144531,295.6533203,83.703125,295.6533203,80.7128906z"/>
                                <path class="st2" d="M309.4853516,86.640625v-9.1259766c0-1.0917969-0.4160156-1.3261719-1.1435547-1.3261719
                                    c-0.625,0-1.1699219,0.6240234-1.7421875,1.4824219v8.9697266h-1.8466797v-9.1259766
                                    c0-1.0917969-0.4160156-1.3261719-1.1435547-1.3261719c-0.6240234,0-1.1699219,0.6240234-1.7421875,1.4824219v8.9697266h-1.8457031
                                    V74.7841797l1.8457031-0.3378906v1.6123047c0.5976562-1.1181641,1.4824219-1.6640625,2.3925781-1.6640625
                                    c1.1699219,0,1.9238281,0.8837891,2.1835938,1.8720703c0.6240234-1.2480469,1.5859375-1.8720703,2.5478516-1.8720703
                                    c1.5087891,0,2.3408203,1.4296875,2.3408203,2.9902344v9.2558594H309.4853516z"/>
                                <path class="st2" d="M313.8535156,70.5458984c0-0.8056641,0.4667969-1.5078125,1.3251953-1.5078125
                                    s1.3261719,0.7021484,1.3261719,1.5078125c0,0.8066406-0.4677734,1.5087891-1.3261719,1.5087891
                                    S313.8535156,71.3525391,313.8535156,70.5458984z M314.2431641,86.640625V74.7841797l1.8457031-0.3378906V86.640625H314.2431641z"
                                    />
                                <path class="st2" d="M325.0068359,85.8613281c-0.5976562,0.7011719-1.4560547,1.1171875-2.4960938,1.1171875
                                    c-2.4960938,0-3.9257812-2.1318359-3.9257812-6.265625c0-4.1083984,1.4560547-6.3183594,4.0302734-6.3183594
                                    c1.0136719,0,1.7939453,0.3896484,2.4179688,1.0400391l-0.4423828,1.8457031
                                    c-0.4160156-0.6757812-1.2216797-1.2216797-1.8720703-1.2216797c-1.5605469,0-2.2099609,1.5859375-2.2099609,4.6279297
                                    c0,3.1201172,0.6757812,4.6279297,2.2880859,4.6279297c0.6757812,0,1.2998047-0.5195312,1.7939453-1.2216797
                                    L325.0068359,85.8613281z"/>
                                <path class="st2" d="M327.3720703,84.4052734c0.7021484,0.5712891,1.4560547,0.9355469,2.2099609,0.9355469
                                    c0.9882812,0,1.5859375-0.7275391,1.5859375-1.6904297c0-0.9619141-0.5195312-1.6113281-1.7675781-2.3398438
                                    c-1.5341797-0.9101562-2.4443359-1.9755859-2.4443359-3.6923828c0-1.9238281,1.4560547-3.2236328,3.2763672-3.2236328
                                    c0.9619141,0,1.8457031,0.3896484,2.4179688,0.8056641l-0.3896484,1.6640625
                                    c-0.6503906-0.4677734-1.3261719-0.8056641-2.0537109-0.8056641c-0.8583984,0-1.4824219,0.5722656-1.4824219,1.5341797
                                    c0,0.9101562,0.3896484,1.5078125,1.6640625,2.2880859c1.5078125,0.9355469,2.5478516,2.0019531,2.5478516,3.7441406
                                    c0,2.0019531-1.4560547,3.3535156-3.3017578,3.3535156c-0.9628906,0-1.9501953-0.3632812-2.6523438-0.9091797
                                    L327.3720703,84.4052734z"/>
                            </g>
                            <path class="st0" d="M130.960556,86.6070557c-1.5654297,0-2.8347168-1.269043-2.8347168-2.8344727V50.0699463
                                c0-1.5654297,1.2692871-2.8344727,2.8347168-2.8344727s2.8347168,1.269043,2.8347168,2.8344727V83.772583
                                C133.7952728,85.3380127,132.5259857,86.6070557,130.960556,86.6070557z"/>
                            <g>
                                <path class="st0" d="M192.9661865,63.5621338c-0.7827148,0-1.4172363-0.6347656-1.4172363-1.4174805V48.8135986
                                    c0-0.7827148,0.6345215-1.4174805,1.4172363-1.4174805s1.4172363,0.6347656,1.4172363,1.4174805v13.3310547
                                    C194.3834229,62.9273682,193.7489014,63.5621338,192.9661865,63.5621338z"/>
                                <rect x="178.5094299" y="47.385025" class="st3" width="13.0393705" height="16.1862202"/>
                                <rect x="194.3834381" y="47.385025" class="st3" width="13.0393705" height="16.1862202"/>
                            </g>
                            <g>
                                <path class="st2" d="M135.4573975,34.4516487c-4.046875,0-7.2783203-2.1015625-7.2783203-6.4374981V16.2690334h3.7832031
                                    v11.2988281c0,2.8378906,2.1289062,3.9150391,3.9414062,3.9150391c1.9443359,0,3.7578125-1.0771484,3.7578125-3.8105469V16.2690334
                                    h3.7314453v11.4033203C143.3929443,32.0873909,140.239624,34.4516487,135.4573975,34.4516487z"/>
                                <path class="st2" d="M156.1673584,34.136219v-8.0927715c0-1.8652344-0.9980469-2.8115234-2.6533203-2.8115234
                                    c-0.9462891,0-1.8652344,0.2890625-2.5224609,0.7099609v10.194334H147.49646V20.8676662l3.3632812-0.2626953l-0.0517578,1.8388672
                                    h0.1044922c0.9726562-1.0771484,2.5751953-2.0234375,4.4150391-2.0234375c2.3642578,0,4.3085938,1.5771484,4.3085938,4.5986328
                                    v9.1171856H156.1673584z"/>
                                <path class="st2" d="M165.0794678,18.2661037c-0.9990234,0-1.8398438-0.8408203-1.8398438-1.8652344
                                    c0-1.0253906,0.8408203-1.8134766,1.8398438-1.8134766c1.0244141,0,1.8388672,0.7880859,1.8388672,1.8134766
                                    C166.918335,17.4252834,166.1038818,18.2661037,165.0794678,18.2661037z M163.3187256,34.136219V20.7358303h3.5214844V34.136219
                                    H163.3187256z"/>
                                <path class="st2" d="M177.036499,34.2153206h-2.9433594l-5.3603516-13.4794903h3.9414062l2.3916016,7.0947266
                                    c0.3935547,1.1035156,0.7089844,2.9951172,0.7089844,2.9951172s0.3154297-1.8652344,0.7099609-2.9951172l2.390625-7.0947266
                                    h3.546875L177.036499,34.2153206z"/>
                                <path class="st2" d="M195.5111084,27.9350491h-8.8808594c0.0791016,2.2070312,1.5507812,3.8886719,4.0205078,3.8886719
                                    c1.5761719,0,2.9951172-0.3408203,4.5712891-0.9453125l-0.1572266,2.4697247
                                    c-1.6289062,0.6572266-3.2314453,1.0771484-5.3603516,1.0771484c-4.0205078,0-6.4638672-2.7851543-6.4638672-6.7265606
                                    c0-4.2832031,2.7851562-7.2783203,6.7265625-7.2783203c3.8105469,0,5.6757812,2.6015625,5.6757812,5.5966797
                                    C195.6429443,26.6215725,195.59021,27.4623928,195.5111084,27.9350491z M189.6781006,22.7065334
                                    c-1.6816406,0-2.7324219,1.6025391-2.9160156,3.2060547h5.6484375
                                    C192.4105225,24.1518459,191.4124756,22.7065334,189.6781006,22.7065334z"/>
                                <path class="st2" d="M206.262085,24.3881741c-0.6835938-0.3945312-1.5761719-0.6572266-2.4169922-0.6572266
                                    c-0.8144531,0-1.6035156,0.3417969-2.0498047,0.8144531v9.5908184h-3.4951172V20.8676662l3.3115234-0.2890625l-0.1054688,2.390625
                                    h0.1054688c0.6826172-1.4980469,1.9707031-2.5488281,3.4150391-2.5488281c0.6308594,0,1.3408203,0.1582031,1.7871094,0.4208984
                                    L206.262085,24.3881741z"/>
                                <path class="st2" d="M212.0189209,34.4252815c-1.734375,0-3.1269531-0.3671875-4.2832031-0.9980469l0.3945312-2.6279278
                                    c1.2080078,0.6308594,2.7060547,1.0507812,3.9941406,1.0507812c1.1035156,0,2.1015625-0.3671875,2.1015625-1.3398438
                                    c0-2.1279297-6.0693359-1.6552734-6.0693359-5.9384766c0-2.7060547,2.4697266-4.1513672,5.3339844-4.1513672
                                    c1.4189453,0,2.8896484,0.3945312,3.8623047,0.8144531l-0.3945312,2.5224609
                                    c-1.0244141-0.3935547-2.390625-0.7617188-3.6523438-0.7617188c-0.9453125,0-1.7597656,0.3681641-1.7597656,1.1298828
                                    c0,2.1015625,6.0957031,1.6816406,6.0957031,5.9121094C217.6419678,32.9536018,215.0931396,34.4252815,212.0189209,34.4252815z"/>
                                <path class="st2" d="M222.1634521,18.2661037c-0.9990234,0-1.8398438-0.8408203-1.8398438-1.8652344
                                    c0-1.0253906,0.8408203-1.8134766,1.8398438-1.8134766c1.0244141,0,1.8388672,0.7880859,1.8388672,1.8134766
                                    C224.0023193,17.4252834,223.1878662,18.2661037,222.1634521,18.2661037z M220.40271,34.136219V20.7358303h3.5214844V34.136219
                                    H220.40271z"/>
                                <path class="st2" d="M231.7298584,34.4252815c-2.3642578,0-3.8886719-1.4716797-3.8886719-3.7304668
                                    c0-0.7626953,0.0791016-4.2568359,0.0791016-6.359375v-1.1298828h-1.2617188v-1.3662109l4.3359375-4.0205078h0.3417969v2.9169922
                                    h4.2558594v2.4697266h-4.2558594c0,0.2099609-0.0527344,4.4931641-0.0527344,6.3066406
                                    c0,1.4189453,0.8408203,2.0488281,2.1279297,2.0488281c0.6835938,0,1.4980469-0.078125,2.2861328-0.3408203v2.4169903
                                    C234.567749,34.1098518,233.2279053,34.4252815,231.7298584,34.4252815z"/>
                                <path class="st2" d="M244.4759521,34.1625862c-1.4189453,3.6259766-3.4160156,6.7529297-6.6738281,6.7529297
                                    c-1.0507812,0-1.9970703-0.2626953-2.5751953-0.6044922l0.5517578-2.5224609
                                    c0.5517578,0.2099609,1.1826172,0.3417969,1.8916016,0.3417969c1.8134766,0,3.0224609-2.390625,3.7578125-4.125
                                    l-5.3076172-13.2695293h3.9414062l2.4433594,6.9628906c0.3681641,1.0771484,0.6835938,3.0214844,0.6835938,3.0214844
                                    s0.3935547-1.8916016,0.7617188-3.0214844l2.2597656-6.9628906h3.4941406L244.4759521,34.1625862z"/>
                                <path class="st2" d="M262.6624756,34.4252815c-4.0458984,0-6.6474609-2.9951153-6.6474609-6.779295
                                    c0-4.2304688,2.7851562-7.2255859,7.1992188-7.2255859c4.046875,0,6.6484375,2.9951172,6.6484375,6.7792969
                                    C269.8626709,31.4301662,267.0511475,34.4252815,262.6624756,34.4252815z M262.8997803,22.9955959
                                    c-2.0234375,0-3.2851562,1.9179688-3.2851562,4.3359375c0,2.4433594,1.3144531,4.5185547,3.3632812,4.5185547
                                    c1.9707031,0,3.3115234-1.9179688,3.3115234-4.3085938C266.2894287,25.0717678,264.9749756,22.9955959,262.8997803,22.9955959z"/>
                                <path class="st2" d="M279.9300537,16.42626c-0.4990234-0.1835938-1.1298828-0.3408203-1.7080078-0.3408203
                                    c-0.9990234,0-1.7871094,0.6035156-1.7871094,2.1279297v2.5224609h3.2587891v2.5224609h-3.2587891V34.136219h-3.4941406V23.2582912
                                    h-1.6816406v-2.1279297l1.6816406-0.3945312v-2.3652344c0-3.0742188,2.1806641-4.9394531,5.0976562-4.9394531
                                    c0.8925781,0,1.8388672,0.2626953,2.390625,0.5517578L279.9300537,16.42626z"/>
                                <path class="st2" d="M298.7728271,34.136219l-1.6289062-4.7031231h-5.9648438l-1.5761719,4.7031231h-3.8632812
                                    l6.4902344-17.8671856h4.1513672L302.87146,34.136219H298.7728271z M294.5950928,21.5239162
                                    c-0.2363281-0.7089844-0.4472656-2.1015625-0.4472656-2.1015625s-0.2099609,1.3398438-0.4726562,2.1015625l-1.8388672,5.3603516
                                    h4.6240234L294.5950928,21.5239162z"/>
                                <path class="st2" d="M313.6224365,34.136219v-8.0927715c0-1.8652344-0.9980469-2.8115234-2.6533203-2.8115234
                                    c-0.9462891,0-1.8652344,0.2890625-2.5224609,0.7099609v10.194334h-3.4951172V20.8676662l3.3632812-0.2626953l-0.0517578,1.8388672
                                    h0.1044922c0.9726562-1.0771484,2.5751953-2.0234375,4.4150391-2.0234375c2.3642578,0,4.3085938,1.5771484,4.3085938,4.5986328
                                    v9.1171856H313.6224365z"/>
                                <path class="st2" d="M324.6888428,34.4252815c-2.3642578,0-3.8886719-1.4716797-3.8886719-3.7304668
                                    c0-0.7626953,0.0791016-4.2568359,0.0791016-6.359375v-1.1298828h-1.2617188v-1.3662109l4.3359375-4.0205078h0.3417969v2.9169922
                                    h4.2558594v2.4697266h-4.2558594c0,0.2099609-0.0527344,4.4931641-0.0527344,6.3066406
                                    c0,1.4189453,0.8408203,2.0488281,2.1279297,2.0488281c0.6835938,0,1.4980469-0.078125,2.2861328-0.3408203v2.4169903
                                    C327.5267334,34.1098518,326.1868896,34.4252815,324.6888428,34.4252815z"/>
                                <path class="st2" d="M345.7122803,34.2153206h-2.7851562l-2.5488281-6.647459
                                    c-0.3945312-1.0253906-0.6572266-2.7851562-0.6572266-2.7851562s-0.3945312,1.7333984-0.7617188,2.7851562l-2.4707031,6.647459
                                    h-2.7060547l-4.5976562-13.4794903h3.8359375l1.8916016,6.5957031c0.3154297,1.0507812,0.6308594,3.0742188,0.6308594,3.0742188
                                    s0.3935547-1.9707031,0.7617188-3.0488281l2.3388672-6.6210938h2.5751953l2.4433594,6.6210938
                                    c0.4199219,1.078125,0.7353516,2.9960938,0.7353516,2.9960938s0.2890625-1.9707031,0.6308594-3.0478516l1.8652344-6.5693359
                                    h3.4423828L345.7122803,34.2153206z"/>
                                <path class="st2" d="M363.637085,27.9350491h-8.8808594c0.0791016,2.2070312,1.5507812,3.8886719,4.0205078,3.8886719
                                    c1.5761719,0,2.9951172-0.3408203,4.5712891-0.9453125l-0.1572266,2.4697247
                                    c-1.6289062,0.6572266-3.2314453,1.0771484-5.3603516,1.0771484c-4.0205078,0-6.4638672-2.7851543-6.4638672-6.7265606
                                    c0-4.2832031,2.7851562-7.2783203,6.7265625-7.2783203c3.8105469,0,5.6757812,2.6015625,5.6757812,5.5966797
                                    C363.7689209,26.6215725,363.7161865,27.4623928,363.637085,27.9350491z M357.8040771,22.7065334
                                    c-1.6816406,0-2.7324219,1.6025391-2.9160156,3.2060547h5.6484375
                                    C360.536499,24.1518459,359.5384521,22.7065334,357.8040771,22.7065334z"/>
                                <path class="st2" d="M374.387085,24.3881741c-0.6835938-0.3945312-1.5761719-0.6572266-2.4169922-0.6572266
                                    c-0.8144531,0-1.6035156,0.3417969-2.0498047,0.8144531v9.5908184h-3.4951172V20.8676662l3.3115234-0.2890625l-0.1054688,2.390625
                                    h0.1054688c0.6826172-1.4980469,1.9707031-2.5488281,3.4150391-2.5488281c0.6308594,0,1.3408203,0.1582031,1.7871094,0.4208984
                                    L374.387085,24.3881741z"/>
                                <path class="st2" d="M382.4036865,34.3207893c-0.7363281,0-1.5507812-0.1845703-1.9970703-0.4208984v6.9365234h-3.4951172
                                    V20.8676662l3.3632812-0.2626953l-0.0517578,1.7861328h0.1044922c0.9726562-1.1826172,2.4960938-1.9707031,3.9941406-1.9707031
                                    c3.3105469,0,5.4130859,2.8115234,5.4130859,6.5429688C389.7347412,31.3774319,386.8704834,34.3207893,382.4036865,34.3207893z
                                    M382.7972412,23.1791897c-0.8925781,0-1.7861328,0.2890625-2.390625,0.7099609v7.3828125
                                    c0.4990234,0.3417969,1.3925781,0.578125,2.1542969,0.578125c2.3125,0,3.6259766-1.8388672,3.6259766-4.2822266
                                    C386.1868896,24.8344631,384.8470459,23.1791897,382.7972412,23.1791897z"/>
                            </g>
                            </svg>
                        </a> <br><br>        
                        When using this data, please cite: 
                        <a href="https://doi.org/10.1016/j.jtrangeo.2024.103918" target="_blank" style="color: blue; text-decoration: underline;">
                            https://doi.org/10.1016/j.jtrangeo.2024.103918
                        </a>. <br><br>
                        If you have any suggestions to improve the map, please click the following link: 
                        <a href="https://forms.office.com/e/Q3jSHHgCT2" target="_blank" style="color: blue; text-decoration: underline;">
                            Provide Feedback
                        </a>
                    `;
                    return div;
                };
                legend.addTo(map);
            }

            function createControlPanel() {
                var controlPanel = document.createElement('div');
                controlPanel.className = 'leaflet-control-layers';

                var mainTitle = document.createElement('div');
                mainTitle.className = 'layer-title';
                mainTitle.textContent = 'Filters';
                controlPanel.appendChild(mainTitle);

                var modeSectionTitle = document.createElement('div');
                modeSectionTitle.className = 'section-title';
                modeSectionTitle.textContent = 'Mode';
                controlPanel.appendChild(modeSectionTitle);

                var modeButtonsContainer = document.createElement('div');
                modeButtonsContainer.className = 'mode-buttons';
                controlPanel.appendChild(modeButtonsContainer);

                var modelSectionTitle = document.createElement('div');
                modelSectionTitle.className = 'section-title';
                modelSectionTitle.textContent = 'Operational model';
                controlPanel.appendChild(modelSectionTitle);

                var modelButtonsContainer = document.createElement('div');
                modelButtonsContainer.className = 'model-buttons';
                controlPanel.appendChild(modelButtonsContainer);

                document.body.appendChild(controlPanel);
            }    


            function createModeButton(mode) {
                var button = document.createElement('button');
                button.textContent = mode;
                button.className = 'mode-button active';
                button.onclick = function() {
                    toggleMode(mode, button);
                };
                document.querySelector('.mode-buttons').appendChild(button);
                modeButtons[mode] = button;
                modesFilter[mode] = true;
            }

            function createModelButton(model) {
                var button = document.createElement('button');
                button.textContent = model;
                button.className = 'model-button active';
                button.onclick = function() {
                    toggleModel(model, button);
                };
                document.querySelector('.model-buttons').appendChild(button);
                modelButtons[model] = button;
            }

            function toggleModel(model, button) {
                // Toggle the clicked model
                modelsFilter[model] = !modelsFilter[model];
                button.classList.toggle('active', modelsFilter[model]);

                // Update the display based on the active models
                Object.keys(cities).forEach(function(city) {
                    updatePopup(city);
                });
            }

            var firstClick = true;

            function toggleMode(mode, button) {
                if (firstClick) {
                    // First click: deactivate all other layers except the clicked one
                    Object.keys(modesFilter).forEach(function(otherMode) {
                        if (otherMode !== mode) {
                            modesFilter[otherMode] = false;
                            modeButtons[otherMode].classList.remove('active');
                        }
                    });
                    firstClick = false;

                    // Activate the clicked mode
                    modesFilter[mode] = true;
                    button.classList.add('active');
                } else {
                    // Toggle the clicked mode on subsequent clicks
                    modesFilter[mode] = !modesFilter[mode];
                    button.classList.toggle('active', modesFilter[mode]);
                }

                // Update the display based on the active modes
                Object.keys(cities).forEach(function(city) {
                    updatePopup(city);
                });
            }

            function updatePopup(city) {
                var modesInfo = "";
                var visible = false;
                Object.keys(cities[city].modes).forEach(function(mode) {
                    var modeOperators = "";

                    if (modesFilter[mode]) {
                        cities[city].modes[mode].forEach(function(detail) {
                            var operationalModel = detail.split('(')[1].replace(')', '').trim();
                            if (modelsFilter[operationalModel]) {
                                visible = true;
                                modeOperators += `- <a href="#" onclick="showProviderInfo('${detail.split(' ')[0]}')" style="color: blue; text-decoration: underline;">${detail}</a><br>`;
                            }
                        });

                        if (modeOperators) {
                            modesInfo += `<b>${mode}:</b><br>${modeOperators}`;
                        }
                    }
                });

                console.log(`Updating popup for ${city} with filters:`, modesFilter, modelsFilter);

                // Add the hyperlink for the city to open the modal
                var cityLink = `<br><a href="#" onclick="showCityInfo('${city}')" style="color: blue; text-decoration: underline;">More data for ${city}</a>`;

                cities[city].marker.bindPopup(`<b>${city}</b><br>${modesInfo}${cityLink}`);
                if (visible) {
                    cities[city].marker.addTo(map);
                } else {
                    map.removeLayer(cities[city].marker);
                }
            }

            window.showProviderInfo = function(provider) {
                const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRO8-rpObUaLG4kgtBLeSD0YZf7dKwNxzXaqOT8L7DQQVBtYE2EsabrnK8mWlpnKg/pub?gid=1506700456&single=true&output=csv";
                fetch(csvUrl)
                    .then(response => response.text())
                    .then(csvData => {
                        Papa.parse(csvData, {
                            header: true,
                            dynamicTyping: true,
                            complete: function (results) {
                                var data = results.data;
                                var providerData = data.filter(row => row['Operator/Service provider'] === provider);
                                
                                // Sort the providerData by country
                                providerData.sort((a, b) => {
                                        if (a['Country'] < b['Country']) return -1;
                                        if (a['Country'] > b['Country']) return 1;
                                        return 0;
                                });
                                
                                
                                var providerInfo = providerData.map(row => {
                                    return `<tr>
                                        <td>${row['City']}</td>
                                        <td>${row['Country']}</td>
                                        <td>${row['Operator/Service provider']}</td>
                                        <td>${row['Mode']}</td>
                                        <td>${row['Operational model']}</td>
                                    </tr>`;
                                }).join('');

                                var table = `<table><thead><tr>
                                    <th>City</th>
                                    <th>Country</th>
                                    <th>Operator/Service provider</th>
                                    <th>Mode</th>
                                    <th>Operational model</th>
                                </tr></thead><tbody>${providerInfo}</tbody></table>`;

                                document.getElementById('city-info-content').innerHTML = table;
                                document.getElementById('city-info-modal').style.display = 'block';
                            }
                        });
                    })
                    .catch(error => {
                        console.error('Error fetching CSV:', error);
                        document.getElementById('city-info-content').innerHTML = '<p>Error loading data.</p>';
                        document.getElementById('city-info-modal').style.display = 'block';
                    });
            }

            window.showCityInfo = function(city) {
                const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRO8-rpObUaLG4kgtBLeSD0YZf7dKwNxzXaqOT8L7DQQVBtYE2EsabrnK8mWlpnKg/pub?gid=1506700456&single=true&output=csv";
                fetch(csvUrl)
                    .then(response => response.text())
                    .then(csvData => {
                        Papa.parse(csvData, {
                            header: true,
                            dynamicTyping: true,
                            complete: function (results) {
                                var data = results.data;
                                var cityData = data.filter(row => row['City'] === city);
                                var cityInfo = cityData.map(row => {
                                    return `<tr>
                                        <td>${row['City']}</td>
                                        <td>${row['Country']}</td>
                                        <td><a href="#" onclick="showProviderInfo('${row['Operator/Service provider']}')">${row['Operator/Service provider']}</a></td>
                                        <td>${row['Mode']}</td>
                                        <td>${row['Operational model']}</td>
                                        <td>${row['Public or private involvement']}</td>
                                        <td>${row['Founded in country']}</td>
                                        <td>${row['Official company name']}</td>
                                        <td>${row['Begin date of scheme']}</td>
                                        <td>${row['End date of scheme']}</td>
                                    </tr>`;
                                }).join('');

                                var table = `<table><thead><tr>
                                    <th>City</th>
                                    <th>Country</th>
                                    <th>Operator/Service provider</th>
                                    <th>Mode</th>
                                    <th>Operational model</th>
                                    <th>Public or private involvement</th>
                                    <th>Founded in country</th>
                                    <th>Official company name</th>
                                    <th>Begin date of scheme</th>
                                    <th>End date of scheme</th>
                                </tr></thead><tbody>${cityInfo}</tbody></table>`;

                                document.getElementById('city-info-content').innerHTML = table;
                                document.getElementById('city-info-modal').style.display = 'block';
                            }
                        });
                    })
                    .catch(error => {
                        console.error('Error fetching CSV:', error);
                        document.getElementById('city-info-content').innerHTML = '<p>Error loading data.</p>';
                        document.getElementById('city-info-modal').style.display = 'block';
                    });
            }

            // Function to close the modal
            window.closeModal = function() {
                document.getElementById('city-info-modal').style.display = 'none';
            }

            function addMarkersFromCSV(csvData) {
                Papa.parse(csvData, {
                    header: true,
                    dynamicTyping: true,
                    complete: function (results) {
                        var data = results.data;
                        data.forEach(function(row) {
                            var city = row.City;
                            var latitude = parseFloat(row.Latitude);
                            var longitude = parseFloat(row.Longitude);
                            var mode = row.Mode;
                            var operator = row['Operator/Service provider'];
                            var operationalModel = row['Operational model'];

                            if (!cities[city]) {
                                cities[city] = {
                                    coordinates: [latitude, longitude],
                                    modes: {},
                                    marker: L.marker([latitude, longitude], { icon: getIconForMode(mode) })
                                };
                                cities[city].marker.addTo(map);
                            }

                            if (!cities[city].modes[mode]) {
                                cities[city].modes[mode] = [];
                                if (!modesFilter[mode]) {
                                    modesFilter[mode] = true;
                                    createModeButton(mode);
                                }
                            }

                            cities[city].modes[mode].push(`${operator} (${operationalModel})`);
                            updatePopup(city);
                        });
                    }
                });
            }

            function fetchAndAddMarkersFromCSV() {
                const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRO8-rpObUaLG4kgtBLeSD0YZf7dKwNxzXaqOT8L7DQQVBtYE2EsabrnK8mWlpnKg/pub?gid=1506700456&single=true&output=csv";
                fetch(csvUrl)
                    .then(response => response.text())
                    .then(csvData => addMarkersFromCSV(csvData))
                    .catch(error => {
                        console.error('Error fetching CSV:', error);
                        document.getElementById('data-table-container').innerHTML = '<p>Error loading data.</p>';
                    });
            }

            createLegend();
            
            //createSurveyLink();
            fetchAndAddMarkersFromCSV();

            // Create the model buttons
            createModelButton('Station-based');
            createModelButton('Freefloating');

            //Create tittles
           // createControlPanel()
        });

    </script>
</body>
</html>
